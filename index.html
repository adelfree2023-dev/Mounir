<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø®Ø§Ù„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠØ©</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        :root {
            --primary: #6366f1;
            --primary-dark: #4f46e5;
            --secondary: #10b981;
            --danger: #ef4444;
            --warning: #f59e0b;
            --bg-dark: #0f172a;
            --bg-card: #1e293b;
            --bg-input: #334155;
            --text: #f1f5f9;
            --text-muted: #94a3b8;
            --border: #475569;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, var(--bg-dark) 0%, #1a1a2e 100%);
            color: var(--text);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
        }

        /* Header */
        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 30px;
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            border-radius: 20px;
            box-shadow: 0 10px 40px rgba(99, 102, 241, 0.3);
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
        }

        .header p {
            opacity: 0.9;
            font-size: 1.1rem;
        }

        /* Stats Cards */
        .stats-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: var(--bg-card);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            border: 1px solid var(--border);
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .stat-card .icon {
            font-size: 2rem;
            margin-bottom: 10px;
        }

        .stat-card .value {
            font-size: 1.8rem;
            font-weight: bold;
            color: var(--primary);
        }

        .stat-card .label {
            color: var(--text-muted);
            font-size: 0.9rem;
        }

        /* Form Section */
        .form-section {
            background: var(--bg-card);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            border: 1px solid var(--border);
        }

        .form-section h2 {
            margin-bottom: 25px;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-group label {
            margin-bottom: 8px;
            color: var(--text-muted);
            font-size: 0.9rem;
        }

        .form-group input,
        .form-group select {
            padding: 12px 15px;
            border: 2px solid var(--border);
            border-radius: 10px;
            background: var(--bg-input);
            color: var(--text);
            font-size: 1rem;
            transition: border-color 0.3s, box-shadow 0.3s;
        }

        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.2);
        }

        .form-group input.auto-filled {
            background: rgba(16, 185, 129, 0.1);
            border-color: var(--secondary);
        }

        .btn-magic {
            background: linear-gradient(135deg, #8b5cf6 0%, #6366f1 50%, #06b6d4 100%);
            color: white;
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {

            0%,
            100% {
                box-shadow: 0 0 10px rgba(139, 92, 246, 0.5);
            }

            50% {
                box-shadow: 0 0 20px rgba(99, 102, 241, 0.8);
            }
        }

        .btn-magic:hover {
            transform: translateY(-2px) scale(1.02);
            box-shadow: 0 5px 25px rgba(139, 92, 246, 0.5);
        }

        /* Buttons */
        .btn-group {
            display: flex;
            gap: 15px;
            margin-top: 25px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(99, 102, 241, 0.4);
        }

        .btn-success {
            background: linear-gradient(135deg, var(--secondary) 0%, #059669 100%);
            color: white;
        }

        .btn-success:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(16, 185, 129, 0.4);
        }

        .btn-danger {
            background: linear-gradient(135deg, var(--danger) 0%, #dc2626 100%);
            color: white;
        }

        .btn-danger:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(239, 68, 68, 0.4);
        }

        .btn-warning {
            background: linear-gradient(135deg, var(--warning) 0%, #d97706 100%);
            color: white;
        }

        .btn-warning:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(245, 158, 11, 0.4);
        }

        /* Bulk Generation Section */
        .bulk-section {
            background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 30px;
            border: 2px dashed var(--primary);
            text-align: center;
        }

        .bulk-section h3 {
            color: var(--primary);
            margin-bottom: 15px;
        }

        .bulk-buttons {
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .btn-bulk {
            background: linear-gradient(135deg, #06b6d4 0%, #0891b2 100%);
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 10px;
            font-size: 0.95rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-bulk:hover {
            transform: translateY(-2px) scale(1.05);
            box-shadow: 0 5px 20px rgba(6, 182, 212, 0.4);
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: var(--bg-input);
            border-radius: 4px;
            margin-top: 15px;
            overflow: hidden;
            display: none;
        }

        .progress-bar .progress {
            height: 100%;
            background: linear-gradient(90deg, var(--primary) 0%, var(--secondary) 100%);
            border-radius: 4px;
            transition: width 0.1s;
        }

        /* Table Section */
        .table-section {
            background: var(--bg-card);
            border-radius: 20px;
            padding: 30px;
            border: 1px solid var(--border);
            overflow: hidden;
        }

        .table-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .table-header h2 {
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .table-controls {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .search-box {
            padding: 10px 15px;
            border: 2px solid var(--border);
            border-radius: 10px;
            background: var(--bg-input);
            color: var(--text);
            width: 250px;
        }

        .table-container {
            overflow-x: auto;
            border-radius: 10px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            min-width: 1200px;
        }

        th,
        td {
            padding: 12px 15px;
            text-align: right;
            border-bottom: 1px solid var(--border);
            white-space: nowrap;
        }

        th {
            background: var(--bg-input);
            color: var(--primary);
            font-weight: 600;
            position: sticky;
            top: 0;
        }

        tr:hover {
            background: rgba(99, 102, 241, 0.1);
        }

        .actions {
            display: flex;
            gap: 5px;
        }

        .btn-sm {
            padding: 6px 12px;
            font-size: 0.85rem;
            border-radius: 6px;
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 50px;
            color: var(--text-muted);
        }

        .empty-state .icon {
            font-size: 4rem;
            margin-bottom: 20px;
            opacity: 0.5;
        }

        /* Toast Notification */
        .toast {
            position: fixed;
            bottom: 20px;
            left: 20px;
            background: var(--secondary);
            color: white;
            padding: 15px 25px;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.3);
            transform: translateX(-150%);
            transition: transform 0.3s;
            z-index: 1000;
        }

        .toast.show {
            transform: translateX(0);
        }

        /* Pagination */
        .pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 8px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .pagination button {
            padding: 8px 14px;
            border: 2px solid var(--border);
            background: var(--bg-input);
            color: var(--text);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 500;
        }

        .pagination button:hover:not(:disabled) {
            border-color: var(--primary);
            background: var(--primary);
        }

        .pagination button.active {
            background: var(--primary);
            border-color: var(--primary);
            color: white;
        }

        .pagination button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .pagination-info {
            color: var(--text-muted);
            font-size: 0.9rem;
            margin: 0 15px;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.8rem;
            }

            .form-grid {
                grid-template-columns: 1fr;
            }

            .btn-group {
                flex-direction: column;
            }

            .btn {
                width: 100%;
                justify-content: center;
            }
        }
    </style>
</head>

<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>ğŸ“Š Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø®Ø§Ù„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠØ©</h1>
            <p>Ø£Ø¯Ø®Ù„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª ÙˆØµØ¯Ù‘Ø±Ù‡Ø§ Ø¥Ù„Ù‰ Ù…Ù„Ù Excel Ø¨ØµÙŠØºØ© Ø§Ø­ØªØ±Ø§ÙÙŠØ©</p>
        </div>

        <!-- Stats Cards -->
        <div class="stats-container">
            <div class="stat-card">
                <div class="icon">ğŸ“¦</div>
                <div class="value" id="totalOrders">0</div>
                <div class="label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø·Ù„Ø¨Ø§Øª</div>
            </div>
            <div class="stat-card">
                <div class="icon">ğŸ’°</div>
                <div class="value" id="totalSales">$0</div>
                <div class="label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª</div>
            </div>
            <div class="stat-card">
                <div class="icon">ğŸ“ˆ</div>
                <div class="value" id="totalProfit">$0</div>
                <div class="label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£Ø±Ø¨Ø§Ø­</div>
            </div>
            <div class="stat-card">
                <div class="icon">ğŸŒ</div>
                <div class="value" id="totalCountries">0</div>
                <div class="label">Ø¹Ø¯Ø¯ Ø§Ù„Ø¯ÙˆÙ„</div>
            </div>
        </div>

        <!-- Data Entry Form -->
        <div class="form-section">
            <h2>ğŸ“ Ø¥Ø¯Ø®Ø§Ù„ Ø¨ÙŠØ§Ù†Ø§Øª Ø¬Ø¯ÙŠØ¯Ø©</h2>
            <form id="salesForm">
                <div class="form-grid">
                    <!-- Order Info -->
                    <div class="form-group">
                        <label>Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨ (ØªÙ„Ù‚Ø§Ø¦ÙŠ)</label>
                        <input type="text" id="orderId" readonly>
                    </div>
                    <div class="form-group">
                        <label>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø·Ù„Ø¨ *</label>
                        <input type="date" id="orderDate" required>
                    </div>
                    <div class="form-group">
                        <label>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø´Ø­Ù†</label>
                        <input type="date" id="shipDate">
                    </div>
                    <div class="form-group">
                        <label>ØªØ§Ø±ÙŠØ® Ø§Ù„ØªØ³Ù„ÙŠÙ…</label>
                        <input type="date" id="deliveryDate">
                    </div>
                    <div class="form-group">
                        <label>Ø­Ø§Ù„Ø© Ø§Ù„Ø·Ù„Ø¨ *</label>
                        <select id="orderStatus" required>
                            <option value="">Ø§Ø®ØªØ±...</option>
                            <option value="Completed">Completed - Ù…ÙƒØªÙ…Ù„</option>
                            <option value="Pending">Pending - Ù‚ÙŠØ¯ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±</option>
                            <option value="Shipped">Shipped - ØªÙ… Ø§Ù„Ø´Ø­Ù†</option>
                            <option value="Cancelled">Cancelled - Ù…Ù„ØºÙŠ</option>
                            <option value="Returned">Returned - Ù…Ø±ØªØ¬Ø¹</option>
                        </select>
                    </div>

                    <!-- Customer Info -->
                    <div class="form-group">
                        <label>Ø±Ù‚Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„ (ØªÙ„Ù‚Ø§Ø¦ÙŠ)</label>
                        <input type="text" id="customerId" readonly>
                    </div>
                    <div class="form-group">
                        <label>Ø´Ø±ÙŠØ­Ø© Ø§Ù„Ø¹Ù…ÙŠÙ„ *</label>
                        <select id="customerSegment" required>
                            <option value="">Ø§Ø®ØªØ±...</option>
                            <option value="Enterprise">Enterprise - Ø´Ø±ÙƒØ§Øª ÙƒØ¨Ø±Ù‰</option>
                            <option value="SMB">SMB - Ø´Ø±ÙƒØ§Øª ØµØºÙŠØ±Ø© ÙˆÙ…ØªÙˆØ³Ø·Ø©</option>
                            <option value="Individual">Individual - Ø£ÙØ±Ø§Ø¯</option>
                            <option value="Government">Government - Ø­ÙƒÙˆÙ…ÙŠ</option>
                            <option value="Education">Education - ØªØ¹Ù„ÙŠÙ…ÙŠ</option>
                        </select>
                    </div>

                    <!-- Geographic Info -->
                    <div class="form-group">
                        <label>Ø§Ù„Ù…Ù†Ø·Ù‚Ø© *</label>
                        <select id="region" required onchange="updateCountries()">
                            <option value="">Ø§Ø®ØªØ±...</option>
                            <option value="North America">North America - Ø£Ù…Ø±ÙŠÙƒØ§ Ø§Ù„Ø´Ù…Ø§Ù„ÙŠØ©</option>
                            <option value="Europe">Europe - Ø£ÙˆØ±ÙˆØ¨Ø§</option>
                            <option value="Asia Pacific">Asia Pacific - Ø¢Ø³ÙŠØ§ ÙˆØ§Ù„Ù…Ø­ÙŠØ· Ø§Ù„Ù‡Ø§Ø¯Ø¦</option>
                            <option value="Latin America">Latin America - Ø£Ù…Ø±ÙŠÙƒØ§ Ø§Ù„Ù„Ø§ØªÙŠÙ†ÙŠØ©</option>
                            <option value="Middle East & Africa">Middle East & Africa - Ø§Ù„Ø´Ø±Ù‚ Ø§Ù„Ø£ÙˆØ³Ø· ÙˆØ£ÙØ±ÙŠÙ‚ÙŠØ§</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Ø§Ù„Ø¯ÙˆÙ„Ø© *</label>
                        <select id="country" required>
                            <option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…Ù†Ø·Ù‚Ø© Ø£ÙˆÙ„Ø§Ù‹...</option>
                        </select>
                    </div>

                    <!-- Product Info -->
                    <div class="form-group">
                        <label>ÙØ¦Ø© Ø§Ù„Ù…Ù†ØªØ¬ *</label>
                        <select id="productCategory" required onchange="updateProducts()">
                            <option value="">Ø§Ø®ØªØ±...</option>
                            <option value="Electronics">Electronics - Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ§Øª</option>
                            <option value="Furniture">Furniture - Ø£Ø«Ø§Ø«</option>
                            <option value="Office Supplies">Office Supplies - Ù…Ø³ØªÙ„Ø²Ù…Ø§Øª Ù…ÙƒØªØ¨ÙŠØ©</option>
                            <option value="Clothing">Clothing - Ù…Ù„Ø§Ø¨Ø³</option>
                            <option value="Food & Beverages">Food & Beverages - Ø£Ø·Ø¹Ù…Ø© ÙˆÙ…Ø´Ø±ÙˆØ¨Ø§Øª</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬ *</label>
                        <select id="productName" required>
                            <option value="">Ø§Ø®ØªØ± Ø§Ù„ÙØ¦Ø© Ø£ÙˆÙ„Ø§Ù‹...</option>
                        </select>
                    </div>

                    <!-- Financial Info -->
                    <div class="form-group">
                        <label>Ø§Ù„ÙƒÙ…ÙŠØ© *</label>
                        <input type="number" id="quantity" min="1" required onchange="calculateTotals()">
                    </div>
                    <div class="form-group">
                        <label>Ø³Ø¹Ø± Ø§Ù„ÙˆØ­Ø¯Ø© ($) *</label>
                        <input type="number" id="unitPrice" step="0.01" min="0" required onchange="calculateTotals()">
                    </div>
                    <div class="form-group">
                        <label>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª (ØªÙ„Ù‚Ø§Ø¦ÙŠ)</label>
                        <input type="text" id="grossSales" readonly>
                    </div>
                    <div class="form-group">
                        <label>Ù†Ø³Ø¨Ø© Ø§Ù„Ø®ØµÙ… %</label>
                        <select id="discountPercent" onchange="calculateTotals()">
                            <option value="0">0%</option>
                            <option value="5">5%</option>
                            <option value="10">10%</option>
                            <option value="15">15%</option>
                            <option value="20">20%</option>
                            <option value="25">25%</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Ù…Ø¨Ù„Øº Ø§Ù„Ø®ØµÙ… (ØªÙ„Ù‚Ø§Ø¦ÙŠ)</label>
                        <input type="text" id="discountAmount" readonly>
                    </div>
                    <div class="form-group">
                        <label>ØµØ§ÙÙŠ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª (ØªÙ„Ù‚Ø§Ø¦ÙŠ)</label>
                        <input type="text" id="netSales" readonly>
                    </div>
                    <div class="form-group">
                        <label>ØªÙƒÙ„ÙØ© Ø§Ù„Ø¨Ø¶Ø§Ø¹Ø© ($) *</label>
                        <input type="number" id="costOfGoods" step="0.01" min="0" required onchange="calculateTotals()">
                    </div>
                    <div class="form-group">
                        <label>Ø§Ù„Ø±Ø¨Ø­ (ØªÙ„Ù‚Ø§Ø¦ÙŠ)</label>
                        <input type="text" id="profit" readonly>
                    </div>
                    <div class="form-group">
                        <label>Ù‡Ø§Ù…Ø´ Ø§Ù„Ø±Ø¨Ø­ % (ØªÙ„Ù‚Ø§Ø¦ÙŠ)</label>
                        <input type="text" id="profitMargin" readonly>
                    </div>

                    <!-- Sales Info -->
                    <div class="form-group">
                        <label>Ù‚Ù†Ø§Ø© Ø§Ù„Ø¨ÙŠØ¹ *</label>
                        <select id="salesChannel" required>
                            <option value="">Ø§Ø®ØªØ±...</option>
                            <option value="Direct Sales">Direct Sales - Ù…Ø¨ÙŠØ¹Ø§Øª Ù…Ø¨Ø§Ø´Ø±Ø©</option>
                            <option value="Online">Online - Ø¹Ø¨Ø± Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª</option>
                            <option value="Retail">Retail - ØªØ¬Ø²Ø¦Ø©</option>
                            <option value="Partner">Partner - Ø´Ø±ÙŠÙƒ</option>
                            <option value="Distributor">Distributor - Ù…ÙˆØ²Ø¹</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹ *</label>
                        <select id="paymentMethod" required>
                            <option value="">Ø§Ø®ØªØ±...</option>
                            <option value="Credit Card">Credit Card - Ø¨Ø·Ø§Ù‚Ø© Ø§Ø¦ØªÙ…Ø§Ù†</option>
                            <option value="Bank Transfer">Bank Transfer - ØªØ­ÙˆÙŠÙ„ Ø¨Ù†ÙƒÙŠ</option>
                            <option value="PayPal">PayPal</option>
                            <option value="Check">Check - Ø´ÙŠÙƒ</option>
                            <option value="Cash">Cash - Ù†Ù‚Ø¯ÙŠ</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Ù…Ù†Ø¯ÙˆØ¨ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª *</label>
                        <select id="salesRep" required>
                            <option value="">Ø§Ø®ØªØ±...</option>
                        </select>
                    </div>
                </div>

                <div class="btn-group">
                    <button type="button" class="btn btn-magic" onclick="autoFillForm()">
                        ğŸ² Ù…Ù„Ø¡ ØªÙ„Ù‚Ø§Ø¦ÙŠ Ø¹Ø´ÙˆØ§Ø¦ÙŠ
                    </button>
                    <button type="submit" class="btn btn-primary">
                        â• Ø¥Ø¶Ø§ÙØ© Ø³Ø¬Ù„ Ø¬Ø¯ÙŠØ¯
                    </button>
                    <button type="button" class="btn btn-warning" onclick="resetForm()">
                        ğŸ”„ Ù…Ø³Ø­ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
                    </button>
                </div>
            </form>
        </div>

        <!-- Bulk Generation Section -->
        <div class="bulk-section">
            <h3>âš¡ ØªÙˆÙ„ÙŠØ¯ Ø³Ø¬Ù„Ø§Øª Ù…ØªØ¹Ø¯Ø¯Ø© Ø¯ÙØ¹Ø© ÙˆØ§Ø­Ø¯Ø©</h3>
            <div class="bulk-buttons">
                <button class="btn-bulk" onclick="generateBulkRecords(100)">ğŸ“¦ 100 Ø³Ø¬Ù„</button>
                <button class="btn-bulk" onclick="generateBulkRecords(500)">ğŸ“¦ 500 Ø³Ø¬Ù„</button>
                <button class="btn-bulk" onclick="generateBulkRecords(1000)">ğŸ“¦ 1,000 Ø³Ø¬Ù„</button>
                <button class="btn-bulk" onclick="generateBulkRecords(5000)">ğŸ“¦ 5,000 Ø³Ø¬Ù„</button>
            </div>
            <div class="progress-bar" id="progressBar">
                <div class="progress" id="progress"></div>
            </div>
            <p id="progressText" style="margin-top: 10px; color: var(--text-muted); display: none;"></p>
        </div>

        <!-- Data Table -->
        <div class="table-section">
            <div class="table-header">
                <h2>ğŸ“‹ Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª</h2>
                <div class="table-controls">
                    <input type="text" class="search-box" placeholder="ğŸ” Ø¨Ø­Ø«..." onkeyup="searchTable(this.value)">
                    <button class="btn btn-success" onclick="exportToExcel()">
                        ğŸ“¥ ØªØµØ¯ÙŠØ± Excel
                    </button>
                    <button class="btn btn-danger" onclick="clearAllData()">
                        ğŸ—‘ï¸ Ø­Ø°Ù Ø§Ù„ÙƒÙ„
                    </button>
                </div>
            </div>
            <div class="table-container">
                <table id="dataTable">
                    <thead>
                        <tr>
                            <th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                            <th>Order ID</th>
                            <th>Order Date</th>
                            <th>Status</th>
                            <th>Customer ID</th>
                            <th>Segment</th>
                            <th>Region</th>
                            <th>Country</th>
                            <th>Category</th>
                            <th>Product</th>
                            <th>Qty</th>
                            <th>Unit Price</th>
                            <th>Gross Sales</th>
                            <th>Discount %</th>
                            <th>Net Sales</th>
                            <th>Profit</th>
                            <th>Profit %</th>
                            <th>Channel</th>
                            <th>Payment</th>
                            <th>Sales Rep</th>
                        </tr>
                    </thead>
                    <tbody id="tableBody">
                    </tbody>
                </table>
            </div>
            <div id="emptyState" class="empty-state">
                <div class="icon">ğŸ“­</div>
                <h3>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ø¹Ø¯</h3>
                <p>Ø§Ø¨Ø¯Ø£ Ø¨Ø¥Ø¶Ø§ÙØ© Ø³Ø¬Ù„Ø§Øª Ù…Ø¨ÙŠØ¹Ø§Øª Ø¬Ø¯ÙŠØ¯Ø©</p>
            </div>
            <div id="paginationContainer" class="pagination"></div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div id="toast" class="toast"></div>

    <script>
        // Data Maps
        const countriesByRegion = {
            'North America': ['USA', 'Canada', 'Mexico'],
            'Europe': ['Germany', 'UK', 'France', 'Italy', 'Spain', 'Netherlands'],
            'Asia Pacific': ['China', 'Japan', 'India', 'Australia', 'Singapore', 'South Korea'],
            'Latin America': ['Brazil', 'Argentina', 'Chile', 'Colombia', 'Peru'],
            'Middle East & Africa': ['UAE', 'Saudi Arabia', 'South Africa', 'Egypt', 'Nigeria']
        };

        const productsByCategory = {
            'Electronics': ['Laptop', 'Desktop Computer', 'Tablet', 'Smartphone', 'Monitor', 'Printer', 'Camera', 'Headphones'],
            'Furniture': ['Office Chair', 'Desk', 'Filing Cabinet', 'Conference Table', 'Bookshelf', 'Sofa', 'Lamp'],
            'Office Supplies': ['Paper', 'Pens', 'Notebooks', 'Folders', 'Staplers', 'Ink Cartridges', 'Binders'],
            'Clothing': ['Business Suit', 'Shirt', 'Pants', 'Dress', 'Shoes', 'Jacket', 'Tie'],
            'Food & Beverages': ['Coffee', 'Tea', 'Snacks', 'Water', 'Soft Drinks', 'Energy Bars']
        };

        const salesReps = [
            { id: 'Rep_001', name: 'John Smith' },
            { id: 'Rep_002', name: 'Sarah Johnson' },
            { id: 'Rep_003', name: 'Michael Brown' },
            { id: 'Rep_004', name: 'Emily Davis' },
            { id: 'Rep_005', name: 'David Wilson' },
            { id: 'Rep_006', name: 'Jessica Martinez' },
            { id: 'Rep_007', name: 'Robert Taylor' },
            { id: 'Rep_008', name: 'Lisa Anderson' },
            { id: 'Rep_009', name: 'James Thomas' },
            { id: 'Rep_010', name: 'Maria Garcia' },
            { id: 'Rep_011', name: 'William Rodriguez' },
            { id: 'Rep_012', name: 'Jennifer Lee' },
            { id: 'Rep_013', name: 'Richard White' },
            { id: 'Rep_014', name: 'Laura Harris' },
            { id: 'Rep_015', name: 'Charles Clark' },
            { id: 'Rep_016', name: 'Patricia Lewis' },
            { id: 'Rep_017', name: 'Daniel Walker' },
            { id: 'Rep_018', name: 'Nancy Hall' },
            { id: 'Rep_019', name: 'Matthew Allen' },
            { id: 'Rep_020', name: 'Karen Young' }
        ];

        // Storage
        let salesData = JSON.parse(localStorage.getItem('salesData')) || [];
        let orderCounter = parseInt(localStorage.getItem('orderCounter')) || 1;
        let editingIndex = -1;

        // Pagination
        const ITEMS_PER_PAGE = 25;
        let currentPage = 1;

        // Initialize
        document.addEventListener('DOMContentLoaded', function () {
            initSalesReps();
            generateOrderId();
            generateCustomerId();
            setDefaultDate();
            renderTable();
            updateStats();
        });

        function initSalesReps() {
            const select = document.getElementById('salesRep');
            salesReps.forEach(rep => {
                const option = document.createElement('option');
                option.value = JSON.stringify(rep);
                option.textContent = `${rep.id} - ${rep.name}`;
                select.appendChild(option);
            });
        }

        function generateOrderId() {
            const year = new Date().getFullYear();
            document.getElementById('orderId').value = `ORD-${year}-${String(orderCounter).padStart(5, '0')}`;
        }

        function generateCustomerId() {
            const randomId = Math.floor(Math.random() * 9000) + 1000;
            document.getElementById('customerId').value = `CUST-${randomId}`;
        }

        function setDefaultDate() {
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('orderDate').value = today;
        }

        // Auto-fill form with random data
        function autoFillForm() {
            // Random date in the last 2 years
            const startDate = new Date(2023, 0, 1);
            const endDate = new Date();
            const randomDate = new Date(startDate.getTime() + Math.random() * (endDate.getTime() - startDate.getTime()));
            const dateStr = randomDate.toISOString().split('T')[0];

            // Ship and delivery dates
            const shipDate = new Date(randomDate.getTime() + (Math.random() * 7 + 1) * 24 * 60 * 60 * 1000);
            const deliveryDate = new Date(shipDate.getTime() + (Math.random() * 14 + 3) * 24 * 60 * 60 * 1000);

            document.getElementById('orderDate').value = dateStr;
            document.getElementById('shipDate').value = shipDate.toISOString().split('T')[0];
            document.getElementById('deliveryDate').value = deliveryDate.toISOString().split('T')[0];

            // Order Status
            const statuses = ['Completed', 'Pending', 'Shipped', 'Cancelled', 'Returned'];
            document.getElementById('orderStatus').value = statuses[Math.floor(Math.random() * statuses.length)];

            // Customer Segment
            const segments = ['Enterprise', 'SMB', 'Individual', 'Government', 'Education'];
            document.getElementById('customerSegment').value = segments[Math.floor(Math.random() * segments.length)];

            // Region and Country
            const regions = Object.keys(countriesByRegion);
            const region = regions[Math.floor(Math.random() * regions.length)];
            document.getElementById('region').value = region;
            updateCountries();
            const countries = countriesByRegion[region];
            document.getElementById('country').value = countries[Math.floor(Math.random() * countries.length)];

            // Product Category and Product
            const categories = Object.keys(productsByCategory);
            const category = categories[Math.floor(Math.random() * categories.length)];
            document.getElementById('productCategory').value = category;
            updateProducts();
            const products = productsByCategory[category];
            document.getElementById('productName').value = products[Math.floor(Math.random() * products.length)];

            // Financial data
            const quantity = Math.floor(Math.random() * 100) + 1;
            const unitPrice = Math.round((Math.random() * 4990 + 10) * 100) / 100;
            document.getElementById('quantity').value = quantity;
            document.getElementById('unitPrice').value = unitPrice;

            // Discount
            const discounts = [0, 5, 10, 15, 20, 25];
            document.getElementById('discountPercent').value = discounts[Math.floor(Math.random() * discounts.length)];

            // Cost of goods (40-70% of gross)
            const grossSales = quantity * unitPrice;
            const costPercent = 0.4 + Math.random() * 0.3;
            const costOfGoods = Math.round(grossSales * costPercent * 100) / 100;
            document.getElementById('costOfGoods').value = costOfGoods;

            // Sales Channel
            const channels = ['Direct Sales', 'Online', 'Retail', 'Partner', 'Distributor'];
            document.getElementById('salesChannel').value = channels[Math.floor(Math.random() * channels.length)];

            // Payment Method
            const payments = ['Credit Card', 'Bank Transfer', 'PayPal', 'Check', 'Cash'];
            document.getElementById('paymentMethod').value = payments[Math.floor(Math.random() * payments.length)];

            // Sales Rep
            const repIndex = Math.floor(Math.random() * salesReps.length);
            document.getElementById('salesRep').selectedIndex = repIndex + 1; // +1 for "Ø§Ø®ØªØ±..." option

            // Calculate totals
            calculateTotals();

            // Add visual feedback
            document.querySelectorAll('.form-group input, .form-group select').forEach(el => {
                el.classList.add('auto-filled');
                setTimeout(() => el.classList.remove('auto-filled'), 1000);
            });

            showToast('ğŸ² ØªÙ… Ù…Ù„Ø¡ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¹Ø´ÙˆØ§Ø¦ÙŠØ§Ù‹ - ÙŠÙ…ÙƒÙ†Ùƒ ØªØ¹Ø¯ÙŠÙ„ Ø£ÙŠ Ø®Ø§Ù†Ø©');
        }

        // Bulk generate records
        async function generateBulkRecords(count) {
            const progressBar = document.getElementById('progressBar');
            const progress = document.getElementById('progress');
            const progressText = document.getElementById('progressText');

            progressBar.style.display = 'block';
            progressText.style.display = 'block';
            progress.style.width = '0%';

            const statuses = ['Completed', 'Pending', 'Shipped', 'Cancelled', 'Returned'];
            const segments = ['Enterprise', 'SMB', 'Individual', 'Government', 'Education'];
            const regions = Object.keys(countriesByRegion);
            const categories = Object.keys(productsByCategory);
            const channels = ['Direct Sales', 'Online', 'Retail', 'Partner', 'Distributor'];
            const payments = ['Credit Card', 'Bank Transfer', 'PayPal', 'Check', 'Cash'];
            const discounts = [0, 5, 10, 15, 20, 25];

            const batchSize = 100;
            let added = 0;

            for (let i = 0; i < count; i++) {
                // Random date
                const startDate = new Date(2023, 0, 1);
                const endDate = new Date();
                const randomDate = new Date(startDate.getTime() + Math.random() * (endDate.getTime() - startDate.getTime()));
                const shipDate = new Date(randomDate.getTime() + (Math.random() * 7 + 1) * 24 * 60 * 60 * 1000);
                const deliveryDate = new Date(shipDate.getTime() + (Math.random() * 14 + 3) * 24 * 60 * 60 * 1000);

                // Random selections
                const region = regions[Math.floor(Math.random() * regions.length)];
                const country = countriesByRegion[region][Math.floor(Math.random() * countriesByRegion[region].length)];
                const category = categories[Math.floor(Math.random() * categories.length)];
                const product = productsByCategory[category][Math.floor(Math.random() * productsByCategory[category].length)];
                const rep = salesReps[Math.floor(Math.random() * salesReps.length)];

                // Financial data
                const quantity = Math.floor(Math.random() * 100) + 1;
                const unitPrice = Math.round((Math.random() * 4990 + 10) * 100) / 100;
                const grossSales = Math.round(quantity * unitPrice * 100) / 100;
                const discountPercent = discounts[Math.floor(Math.random() * discounts.length)];
                const discountAmount = Math.round(grossSales * (discountPercent / 100) * 100) / 100;
                const netSales = Math.round((grossSales - discountAmount) * 100) / 100;
                const costOfGoods = Math.round(netSales * (0.4 + Math.random() * 0.3) * 100) / 100;
                const profit = Math.round((netSales - costOfGoods) * 100) / 100;
                const profitMargin = netSales > 0 ? Math.round((profit / netSales) * 10000) / 100 : 0;

                const year = new Date().getFullYear();
                const record = {
                    orderId: `ORD-${year}-${String(orderCounter).padStart(5, '0')}`,
                    orderDate: randomDate.toISOString().split('T')[0],
                    shipDate: shipDate.toISOString().split('T')[0],
                    deliveryDate: deliveryDate.toISOString().split('T')[0],
                    orderStatus: statuses[Math.floor(Math.random() * statuses.length)],
                    customerId: `CUST-${Math.floor(Math.random() * 9000) + 1000}`,
                    customerSegment: segments[Math.floor(Math.random() * segments.length)],
                    region: region,
                    country: country,
                    productCategory: category,
                    productName: product,
                    quantity: quantity,
                    unitPrice: unitPrice,
                    grossSales: grossSales,
                    discountPercent: discountPercent,
                    discountAmount: discountAmount,
                    netSales: netSales,
                    costOfGoods: costOfGoods,
                    profit: profit,
                    profitMargin: profitMargin,
                    salesChannel: channels[Math.floor(Math.random() * channels.length)],
                    paymentMethod: payments[Math.floor(Math.random() * payments.length)],
                    salesRepId: rep.id,
                    salesRepName: rep.name
                };

                salesData.push(record);
                orderCounter++;
                added++;

                // Update progress every batch
                if (added % batchSize === 0 || added === count) {
                    const percent = Math.round((added / count) * 100);
                    progress.style.width = percent + '%';
                    progressText.textContent = `â³ Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªÙˆÙ„ÙŠØ¯... ${added.toLocaleString()} / ${count.toLocaleString()} (${percent}%)`;
                    await new Promise(r => setTimeout(r, 10)); // Allow UI to update
                }
            }

            localStorage.setItem('salesData', JSON.stringify(salesData));
            localStorage.setItem('orderCounter', orderCounter);

            renderTable();
            updateStats();
            generateOrderId();

            progressBar.style.display = 'none';
            progressText.style.display = 'none';

            showToast(`âœ… ØªÙ… Ø¥Ø¶Ø§ÙØ© ${count.toLocaleString()} Ø³Ø¬Ù„ Ø¨Ù†Ø¬Ø§Ø­!`);
        }

        function updateCountries() {
            const region = document.getElementById('region').value;
            const countrySelect = document.getElementById('country');
            countrySelect.innerHTML = '<option value="">Ø§Ø®ØªØ±...</option>';

            if (region && countriesByRegion[region]) {
                countriesByRegion[region].forEach(country => {
                    const option = document.createElement('option');
                    option.value = country;
                    option.textContent = country;
                    countrySelect.appendChild(option);
                });
            }
        }

        function updateProducts() {
            const category = document.getElementById('productCategory').value;
            const productSelect = document.getElementById('productName');
            productSelect.innerHTML = '<option value="">Ø§Ø®ØªØ±...</option>';

            if (category && productsByCategory[category]) {
                productsByCategory[category].forEach(product => {
                    const option = document.createElement('option');
                    option.value = product;
                    option.textContent = product;
                    productSelect.appendChild(option);
                });
            }
        }

        function calculateTotals() {
            const quantity = parseFloat(document.getElementById('quantity').value) || 0;
            const unitPrice = parseFloat(document.getElementById('unitPrice').value) || 0;
            const discountPercent = parseFloat(document.getElementById('discountPercent').value) || 0;
            const costOfGoods = parseFloat(document.getElementById('costOfGoods').value) || 0;

            const grossSales = quantity * unitPrice;
            const discountAmount = grossSales * (discountPercent / 100);
            const netSales = grossSales - discountAmount;
            const profit = netSales - costOfGoods;
            const profitMargin = netSales > 0 ? (profit / netSales) * 100 : 0;

            document.getElementById('grossSales').value = `$${grossSales.toFixed(2)}`;
            document.getElementById('discountAmount').value = `$${discountAmount.toFixed(2)}`;
            document.getElementById('netSales').value = `$${netSales.toFixed(2)}`;
            document.getElementById('profit').value = `$${profit.toFixed(2)}`;
            document.getElementById('profitMargin').value = `${profitMargin.toFixed(2)}%`;
        }

        // Form Submission
        document.getElementById('salesForm').addEventListener('submit', function (e) {
            e.preventDefault();

            const salesRepData = JSON.parse(document.getElementById('salesRep').value);

            const record = {
                orderId: document.getElementById('orderId').value,
                orderDate: document.getElementById('orderDate').value,
                shipDate: document.getElementById('shipDate').value,
                deliveryDate: document.getElementById('deliveryDate').value,
                orderStatus: document.getElementById('orderStatus').value,
                customerId: document.getElementById('customerId').value,
                customerSegment: document.getElementById('customerSegment').value,
                region: document.getElementById('region').value,
                country: document.getElementById('country').value,
                productCategory: document.getElementById('productCategory').value,
                productName: document.getElementById('productName').value,
                quantity: parseInt(document.getElementById('quantity').value),
                unitPrice: parseFloat(document.getElementById('unitPrice').value),
                grossSales: parseFloat(document.getElementById('grossSales').value.replace('$', '')),
                discountPercent: parseInt(document.getElementById('discountPercent').value),
                discountAmount: parseFloat(document.getElementById('discountAmount').value.replace('$', '')),
                netSales: parseFloat(document.getElementById('netSales').value.replace('$', '')),
                costOfGoods: parseFloat(document.getElementById('costOfGoods').value),
                profit: parseFloat(document.getElementById('profit').value.replace('$', '')),
                profitMargin: parseFloat(document.getElementById('profitMargin').value.replace('%', '')),
                salesChannel: document.getElementById('salesChannel').value,
                paymentMethod: document.getElementById('paymentMethod').value,
                salesRepId: salesRepData.id,
                salesRepName: salesRepData.name
            };

            if (editingIndex >= 0) {
                salesData[editingIndex] = record;
                editingIndex = -1;
                showToast('âœ… ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø³Ø¬Ù„ Ø¨Ù†Ø¬Ø§Ø­');
            } else {
                salesData.push(record);
                orderCounter++;
                localStorage.setItem('orderCounter', orderCounter);
                showToast('âœ… ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø³Ø¬Ù„ Ø¨Ù†Ø¬Ø§Ø­');
            }

            localStorage.setItem('salesData', JSON.stringify(salesData));
            renderTable();
            updateStats();
            resetForm();
        });

        function resetForm() {
            document.getElementById('salesForm').reset();
            generateOrderId();
            generateCustomerId();
            setDefaultDate();
            document.getElementById('country').innerHTML = '<option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…Ù†Ø·Ù‚Ø© Ø£ÙˆÙ„Ø§Ù‹...</option>';
            document.getElementById('productName').innerHTML = '<option value="">Ø§Ø®ØªØ± Ø§Ù„ÙØ¦Ø© Ø£ÙˆÙ„Ø§Ù‹...</option>';
            ['grossSales', 'discountAmount', 'netSales', 'profit', 'profitMargin'].forEach(id => {
                document.getElementById(id).value = '';
            });
            editingIndex = -1;
        }

        function renderTable() {
            const tbody = document.getElementById('tableBody');
            const emptyState = document.getElementById('emptyState');
            const paginationContainer = document.getElementById('paginationContainer');

            if (salesData.length === 0) {
                tbody.innerHTML = '';
                emptyState.style.display = 'block';
                paginationContainer.innerHTML = '';
                return;
            }

            emptyState.style.display = 'none';

            // Calculate pagination
            const totalPages = Math.ceil(salesData.length / ITEMS_PER_PAGE);
            if (currentPage > totalPages) currentPage = totalPages;
            if (currentPage < 1) currentPage = 1;

            const startIndex = (currentPage - 1) * ITEMS_PER_PAGE;
            const endIndex = Math.min(startIndex + ITEMS_PER_PAGE, salesData.length);
            const pageData = salesData.slice(startIndex, endIndex);

            tbody.innerHTML = pageData.map((record, i) => {
                const actualIndex = startIndex + i;
                return `
                <tr>
                    <td class="actions">
                        <button class="btn btn-primary btn-sm" onclick="editRecord(${actualIndex})">âœï¸</button>
                        <button class="btn btn-danger btn-sm" onclick="deleteRecord(${actualIndex})">ğŸ—‘ï¸</button>
                    </td>
                    <td>${record.orderId}</td>
                    <td>${record.orderDate}</td>
                    <td>${record.orderStatus}</td>
                    <td>${record.customerId}</td>
                    <td>${record.customerSegment}</td>
                    <td>${record.region}</td>
                    <td>${record.country}</td>
                    <td>${record.productCategory}</td>
                    <td>${record.productName}</td>
                    <td>${record.quantity}</td>
                    <td>$${record.unitPrice.toFixed(2)}</td>
                    <td>$${record.grossSales.toFixed(2)}</td>
                    <td>${record.discountPercent}%</td>
                    <td>$${record.netSales.toFixed(2)}</td>
                    <td>$${record.profit.toFixed(2)}</td>
                    <td>${record.profitMargin.toFixed(2)}%</td>
                    <td>${record.salesChannel}</td>
                    <td>${record.paymentMethod}</td>
                    <td>${record.salesRepName}</td>
                </tr>
            `}).join('');

            // Render pagination
            renderPagination(totalPages);
        }

        function renderPagination(totalPages) {
            const container = document.getElementById('paginationContainer');
            if (totalPages <= 1) {
                container.innerHTML = '';
                return;
            }

            let html = '';

            // Previous button
            html += `<button onclick="goToPage(${currentPage - 1})" ${currentPage === 1 ? 'disabled' : ''}>â—€ Ø§Ù„Ø³Ø§Ø¨Ù‚</button>`;

            // Page numbers
            const maxVisible = 5;
            let startPage = Math.max(1, currentPage - Math.floor(maxVisible / 2));
            let endPage = Math.min(totalPages, startPage + maxVisible - 1);
            if (endPage - startPage < maxVisible - 1) {
                startPage = Math.max(1, endPage - maxVisible + 1);
            }

            if (startPage > 1) {
                html += `<button onclick="goToPage(1)">1</button>`;
                if (startPage > 2) html += `<span class="pagination-info">...</span>`;
            }

            for (let i = startPage; i <= endPage; i++) {
                html += `<button onclick="goToPage(${i})" class="${i === currentPage ? 'active' : ''}">${i}</button>`;
            }

            if (endPage < totalPages) {
                if (endPage < totalPages - 1) html += `<span class="pagination-info">...</span>`;
                html += `<button onclick="goToPage(${totalPages})">${totalPages}</button>`;
            }

            // Next button
            html += `<button onclick="goToPage(${currentPage + 1})" ${currentPage === totalPages ? 'disabled' : ''}">Ø§Ù„ØªØ§Ù„ÙŠ â–¶</button>`;

            // Info
            html += `<span class="pagination-info">ØµÙØ­Ø© ${currentPage} Ù…Ù† ${totalPages} (Ø¥Ø¬Ù…Ø§Ù„ÙŠ: ${salesData.length.toLocaleString()} Ø³Ø¬Ù„)</span>`;

            container.innerHTML = html;
        }

        function goToPage(page) {
            currentPage = page;
            renderTable();
            // Scroll to table
            document.querySelector('.table-section').scrollIntoView({ behavior: 'smooth' });
        }

        function editRecord(index) {
            const record = salesData[index];
            editingIndex = index;

            document.getElementById('orderId').value = record.orderId;
            document.getElementById('orderDate').value = record.orderDate;
            document.getElementById('shipDate').value = record.shipDate;
            document.getElementById('deliveryDate').value = record.deliveryDate;
            document.getElementById('orderStatus').value = record.orderStatus;
            document.getElementById('customerId').value = record.customerId;
            document.getElementById('customerSegment').value = record.customerSegment;
            document.getElementById('region').value = record.region;
            updateCountries();
            document.getElementById('country').value = record.country;
            document.getElementById('productCategory').value = record.productCategory;
            updateProducts();
            document.getElementById('productName').value = record.productName;
            document.getElementById('quantity').value = record.quantity;
            document.getElementById('unitPrice').value = record.unitPrice;
            document.getElementById('discountPercent').value = record.discountPercent;
            document.getElementById('costOfGoods').value = record.costOfGoods;
            document.getElementById('salesChannel').value = record.salesChannel;
            document.getElementById('paymentMethod').value = record.paymentMethod;

            // Set sales rep
            const salesRepSelect = document.getElementById('salesRep');
            for (let i = 0; i < salesRepSelect.options.length; i++) {
                try {
                    const opt = JSON.parse(salesRepSelect.options[i].value);
                    if (opt.id === record.salesRepId) {
                        salesRepSelect.selectedIndex = i;
                        break;
                    }
                } catch (e) { }
            }

            calculateTotals();
            window.scrollTo({ top: 0, behavior: 'smooth' });
            showToast('ğŸ“ Ø¬Ø§Ø±ÙŠ ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø³Ø¬Ù„...');
        }

        function deleteRecord(index) {
            if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ø³Ø¬Ù„ØŸ')) {
                salesData.splice(index, 1);
                localStorage.setItem('salesData', JSON.stringify(salesData));
                renderTable();
                updateStats();
                showToast('ğŸ—‘ï¸ ØªÙ… Ø­Ø°Ù Ø§Ù„Ø³Ø¬Ù„');
            }
        }

        function clearAllData() {
            if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§ØªØŸ Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù†Ù‡.')) {
                salesData = [];
                localStorage.removeItem('salesData');
                renderTable();
                updateStats();
                showToast('ğŸ—‘ï¸ ØªÙ… Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª');
            }
        }

        function updateStats() {
            const totalOrders = salesData.length;
            const totalSales = salesData.reduce((sum, r) => sum + r.netSales, 0);
            const totalProfit = salesData.reduce((sum, r) => sum + r.profit, 0);
            const countries = new Set(salesData.map(r => r.country)).size;

            document.getElementById('totalOrders').textContent = totalOrders.toLocaleString();
            document.getElementById('totalSales').textContent = `$${totalSales.toLocaleString('en-US', { minimumFractionDigits: 0, maximumFractionDigits: 0 })}`;
            document.getElementById('totalProfit').textContent = `$${totalProfit.toLocaleString('en-US', { minimumFractionDigits: 0, maximumFractionDigits: 0 })}`;
            document.getElementById('totalCountries').textContent = countries;
        }

        function searchTable(query) {
            const rows = document.querySelectorAll('#tableBody tr');
            query = query.toLowerCase();

            rows.forEach(row => {
                const text = row.textContent.toLowerCase();
                row.style.display = text.includes(query) ? '' : 'none';
            });
        }

        function exportToExcel() {
            if (salesData.length === 0) {
                showToast('âŒ Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„ØªØµØ¯ÙŠØ±');
                return;
            }

            // Prepare main data sheet
            const excelData = salesData.map(r => ({
                'Order_ID': r.orderId,
                'Order_Date': r.orderDate,
                'Ship_Date': r.shipDate || '',
                'Delivery_Date': r.deliveryDate || '',
                'Order_Status': r.orderStatus,
                'Customer_ID': r.customerId,
                'Customer_Segment': r.customerSegment,
                'Region': r.region,
                'Country': r.country,
                'Product_Category': r.productCategory,
                'Product_Name': r.productName,
                'Quantity': r.quantity,
                'Unit_Price': r.unitPrice,
                'Gross_Sales': r.grossSales,
                'Discount_Percent': r.discountPercent,
                'Discount_Amount': r.discountAmount,
                'Net_Sales': r.netSales,
                'Cost_of_Goods': r.costOfGoods,
                'Profit': r.profit,
                'Profit_Margin_Percent': r.profitMargin,
                'Sales_Channel': r.salesChannel,
                'Payment_Method': r.paymentMethod,
                'Sales_Rep_ID': r.salesRepId,
                'Sales_Rep_Name': r.salesRepName
            }));

            // Summary data
            const totalGross = salesData.reduce((s, r) => s + r.grossSales, 0);
            const totalNet = salesData.reduce((s, r) => s + r.netSales, 0);
            const totalProfit = salesData.reduce((s, r) => s + r.profit, 0);
            const avgMargin = salesData.reduce((s, r) => s + r.profitMargin, 0) / salesData.length;
            const countries = new Set(salesData.map(r => r.country)).size;
            const products = new Set(salesData.map(r => r.productName)).size;
            const reps = new Set(salesData.map(r => r.salesRepId)).size;
            const dates = salesData.map(r => r.orderDate).sort();

            const summaryData = [
                { Metric: 'Total Records', Value: salesData.length },
                { Metric: 'Total Customers', Value: new Set(salesData.map(r => r.customerId)).size },
                { Metric: 'Total Orders', Value: salesData.length },
                { Metric: 'Date Range', Value: `${dates[0]} to ${dates[dates.length - 1]}` },
                { Metric: 'Total Gross Sales', Value: `$${totalGross.toFixed(2)}` },
                { Metric: 'Total Net Sales', Value: `$${totalNet.toFixed(2)}` },
                { Metric: 'Total Profit', Value: `$${totalProfit.toFixed(2)}` },
                { Metric: 'Average Profit Margin %', Value: `${avgMargin.toFixed(2)}%` },
                { Metric: 'Number of Regions', Value: new Set(salesData.map(r => r.region)).size },
                { Metric: 'Number of Countries', Value: countries },
                { Metric: 'Number of Products', Value: products },
                { Metric: 'Number of Sales Reps', Value: reps }
            ];

            // Create workbook
            const wb = XLSX.utils.book_new();

            // Add Sales Data sheet
            const ws1 = XLSX.utils.json_to_sheet(excelData);
            XLSX.utils.book_append_sheet(wb, ws1, 'Sales_Data');

            // Add Summary sheet
            const ws2 = XLSX.utils.json_to_sheet(summaryData);
            XLSX.utils.book_append_sheet(wb, ws2, 'Summary');

            // Download
            const fileName = `Global_Sales_Data_${new Date().toISOString().split('T')[0]}.xlsx`;
            XLSX.writeFile(wb, fileName);

            showToast('âœ… ØªÙ… ØªØµØ¯ÙŠØ± Ø§Ù„Ù…Ù„Ù Ø¨Ù†Ø¬Ø§Ø­');
        }

        function showToast(message) {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.classList.add('show');
            setTimeout(() => toast.classList.remove('show'), 3000);
        }
    </script>
</body>

</html>